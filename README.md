
# âœˆï¸ CNN Object Detection (Airplane Detector)

This repository contains a **Convolutional Neural Network (CNN)**â€“based object detector
that detects airplanes from images. The project includes:

- A full training pipeline (data preprocessing â†’ cropping â†’ CNN training â†’ saving model)
- A deployment/testing pipeline (load trained model â†’ detect airplanes â†’ draw detections)

---

## ğŸ“‚ Repository Structure

```

ğŸ“ root
â”‚
â”œâ”€â”€ Object_Detector_CNN_Based.ipynb     # Training + model building
â”œâ”€â”€ Final_Testing.ipynb                 # Inference / deployment script
â””â”€â”€ artifacts/                          # Generated automatically (saved model, logs, images)

```

---

## ğŸ§  Model Architecture (from code)

The CNN classifier defined in `Object_Detector_CNN_Based.ipynb`:

```

Input (CROP_SIZE x CROP_SIZE x 3)
â”‚
â”œâ”€â”€ Conv2D (32 filters, kernel 3x3, activation='relu')
â”œâ”€â”€ MaxPooling2D (pool size 2)
â”‚
â”œâ”€â”€ Conv2D (64 filters, kernel 3x3, activation='relu')
â”œâ”€â”€ MaxPooling2D (pool size 2)
â”‚
â”œâ”€â”€ Conv2D (128 filters, kernel 3x3, activation='relu')
â”œâ”€â”€ GlobalAveragePooling2D
â”œâ”€â”€ Dropout (0.40)
â”‚
â””â”€â”€ Dense (num_classes, activation='softmax')

```

The model is compiled with:

```

optimizer = Adam()
loss = SparseCategoricalCrossentropy()
metrics = ['accuracy']

````

---

## ğŸ› ï¸ Training Pipeline (from notebook)

From `Object_Detector_CNN_Based.ipynb`:

1. Preprocess and crop dataset images into fixed-size patches (`CROP_SIZE Ã— CROP_SIZE`)
2. Build CNN classifier using TensorFlow/Keras
3. Compute class weights using:

```python
from sklearn.utils import class_weight
cls_weights = class_weight.compute_class_weight('balanced', ...)
````

4. Train with callbacks:

```python
ModelCheckpoint(save_best_only=True, monitor="val_loss")
EarlyStopping(patience=5, restore_best_weights=True)
```

5. Save trained model to:

```
/artifacts/cnn_detector_best.h5
```

The notebook also plots **loss curve** and **accuracy curve** during training:

```python
plt.plot(history.history['loss'])
plt.plot(history.history['val_loss'])
plt.plot(history.history['accuracy'])
plt.plot(history.history['val_accuracy'])
```

This is automatically generated inside the notebook (no user action needed).

---

## ğŸš€ Deployment / Inference Pipeline

From `Final_Testing.ipynb`:

1. Load trained model

```python
from tensorflow.keras.models import load_model
cnn_model = load_model("/content/drive/MyDrive/airplane_cnn_model.keras")
print("âœ… Model loaded successfully from Drive!")
```

2. Run detection on **a single image**

```python
img_rgb, detections = detect_airplanes(test_img_path, cnn_model, conf_thresh=0.4)
final_detections = non_max_suppression(detections, iou_thresh=0.2)

print(f"âœ… Single image: {len(final_detections)} airplanes detected")
```

3. Run **batch detection** on a folder

```python
batch_detect(test_folder, cnn_model, conf_thresh=0.4, iou_thresh=0.2, limit=5, save_dir="/content/detection_results")
```

The script produces:

* Cropped detection previews
* Final output images stored under `/content/detection_results`

---

## ğŸ” Object Detection Strategy (as implemented)

* Slide a fixed-size crop over the input image
* Run classifier on each crop
* Keep predictions above confidence threshold (`conf_thresh = 0.4`)
* Apply **Non-Max Suppression (NMS)** (`iou_thresh = 0.2`)
* Draw bounding box + label on final image

---

## âœ… Outputs Generated by the Project

The project automatically generates:

| Output                                       | Location                         |
| -------------------------------------------- | -------------------------------- |
| Trained model                                | `artifacts/cnn_detector_best.h5` |
| Intermediate cropped chips                   | `artifacts/crops/`               |
| Final inference images (with bounding boxes) | `detection_results/`             |

When running inference, the console prints:

```
âœ… Model loaded successfully from Drive!
âœ… Single image: X airplanes detected
```

---

## ğŸ§ª Requirements

(These imports appear in the code)

```
tensorflow
numpy
opencv-python
matplotlib
scikit-learn
```

---

## ğŸ How to run

### Training:

Open:

```
Object_Detector_CNN_Based.ipynb
```

Run all the cells.

### Testing / Inference:

Open:

```
Final_Testing.ipynb
```

Update image path â†’ run all cells.

---

## â­ Contribution

Pull requests are welcome.

If you find this helpful, give the repo a â­ on GitHub!

```
